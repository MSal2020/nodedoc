<title>Data Visualisation</title>

<head>
    <!-- loading billboard.js styles from the cdn -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/billboard.js/dist/billboard.min.css" integrity="sha384-1+Kcd5nQisMK3+5HueexbTVzp25By3YKkesoJfHp8HoUiqfpGXaH17mzTVhF6oqL" crossorigin="anonymous">  

    <!--Loading D3.js -->
    <script src="https://d3js.org/d3.v6.min.js" integrity="sha384-ma33ZEb8L5emtidZhYJFZNIFdht2E8f5wHQMKQGom0aIx9rRKm86XXCjGxOISpM9" crossorigin="anonymous"></script>
  
    <!-- Loading billboard.js scripts from the cdn -->
    <script src="https://cdn.jsdelivr.net/npm/billboard.js/dist/billboard.min.js" integrity="sha512-ghMIsvB9YFGsBxYqflN0Qhx+z040Vnd0G327Q2oa9Xn6np4SH9sBQoSfCcFXGMaSp9qFNY4ZLWdrLMDEvjSu4A==" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="style.css" />
  
    <style> 
      .navbar-brand{height: 75px; width: 80px;}

    .tbl-header {
      background-color: rgba(255, 255, 255, 0.3);
    }

    .tbl-content {
      height: 300px;
      overflow-x: auto;
      margin-top: 0px;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    th {
      padding: 20px 15px;
      text-align: left;
      font-weight: 500;
      font-size: 12px;
      color: rgb(0, 0, 0);
      text-transform: uppercase;
    }

    td {
      padding: 15px;
      text-align: left;
      vertical-align: middle;
      font-weight: 300;
      font-size: 12px;
      color: rgb(0, 0, 0);
      border-bottom: solid 1px rgba(255, 255, 255, 0.1);
    }

    p 
    {
      margin-top: 10px;
    }
    h1 {
      font-size: 30px;
      color: #00b5ad;
      text-align: center;
      font-weight: 500;
      margin-bottom: 15px;

    }
    h2 {
      font-size: 30px;
      color: #00b5ad;
      text-align: center;
      font-weight: 500;

    }
    h3
    {
      margin-top: 50px;
      font-size: 30px;
      color: #00b5ad;
      text-align: center;
      font-weight: 500;
    }
    h4
    {
      margin-top: 25px;
      font-size: 22px;
      color: #00b5ad;
      text-align: center;
      font-weight: 500;

    }
    h5{
      color: #00b5ad;

    }
    .readingsnumber{float:left; margin-top: 20px;}
    button
{
  appearance: none;
    -webkit-appearance: none;
    color: #95a5a6;
    font-family: "Helvetica", arial, sans-serif;
    font-size: 13px;
    border:1px solid #ecf0f1;
    border-radius: 15px;
    background:#ecf0f1;
    padding:5px;
    display: inline-block !important;
    visibility: visible !important;
}
    /* demo styles */

    @import url(https://fonts.googleapis.com/css?family=Roboto:400,500,300,700);

    /* for custom scrollbar for webkit browser*/

    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
    }

    ::-webkit-scrollbar-thumb {
      -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
    }
    /* Removes the clear button from date inputs */
input[type="date"]::-webkit-clear-button {
    display: none;
}

/* Removes the spin button */
input[type="date"]::-webkit-inner-spin-button { 
    display: none;
}

/* Always display the drop down caret */
input[type="date"]::-webkit-calendar-picker-indicator {
    color: #2c3e50;
}

/* A few custom styles for date inputs */
input[type="date"] {
    appearance: none;
    -webkit-appearance: none;
    color: #95a5a6;
    font-family: "Helvetica", arial, sans-serif;
    font-size: 13px;
    border:1px solid #ecf0f1;
    border-radius: 15px;
    background:#ecf0f1;
    padding:5px;
    display: inline-block !important;
    visibility: visible !important;
}

input[type="date"], focus {
    color: #95a5a6;
    box-shadow: none;
    -webkit-box-shadow: none;
    -moz-box-shadow: none;
}

input {    
    appearance: none;
    -webkit-appearance: none;
    color: #95a5a6;
    font-family: "Helvetica", arial, sans-serif;
    font-size: 13px;
    border:1px solid #ecf0f1;
    border-radius: 15px;
    background:#ecf0f1;
    padding:5px;
    display: inline-block !important;
    visibility: visible !important;
  }
        .box {
  
          height: 10px;
          width: 10px;
          margin-bottom: 15px;
          border: 1px solid black;
          clear: both;
          margin: auto;
          display: inline-block
        }

        .red {
          background-color: red;
        }

        .green {
          background-color: green;
        }

        .blue {
          background-color: blue;
        }
        .otherblue{
          background-color: #2596be
        }

        .btn {
  width: 160px;
  font-size: 16px;
  font-weight: 600;
  color: #fff;
  cursor: pointer;
  height: 55px;
  text-align:center;
  border: none;
  background-size: 300% 100%;
  moz-transition: all .4s ease-in-out;
  -o-transition: all .4s ease-in-out;
  -webkit-transition: all .4s ease-in-out;
  transition: all .4s ease-in-out;
}

.btn:hover {
  background-position: 100% 0;
  moz-transition: all .4s ease-in-out;
  -o-transition: all .4s ease-in-out;
  -webkit-transition: all .4s ease-in-out;
  transition: all .4s ease-in-out;
}

.btn:focus {
  outline: none;
}

.btn {
  background-image: linear-gradient(
    to right,
    #0ba360,
    #3cba92,
    #30dd8a,
    #2bb673
  );
  box-shadow: 0 4px 15px 0 rgba(23, 168, 108, 0.75);
}

body,
html
{
  text-align: center; 
  height: 100%;

}

.warning
{
  font-size: 22px;
  color: red;
  float: left
}

.nowarning
{
  font-size: 22px;
  float: left
}
.idealrange
{
  float: left;
}
.idealrangeheader
{
  float: left; margin-top: 450px;
}
.downloadButtons
{
  display: none;
}
.summarydashboard1
{
  padding-left: 250px;margin:0 auto; width: 1000px; float: left;
        
}
.summarydashboard2
{
  text-align: center; width: 800px; padding-right: 100px;
}
.idealrangediv
{
  padding-left: 250px;margin:0 auto; width: 1000px; text-align: left;
}
.heartDashboard
{
  display: block;
}
.bloodpressureDashboard
{
  display: none;
}
.temperatureDashboard
{
  display: none;
}
.readingsTable
{
  display: none;
}
.readingsSummary
{
  padding: 50px;margin:0 auto; width: 700px;
}
.summaryreport
{
  display: none;
}
.readingslabeltop
{
  text-align:left; margin-top: 30px;
}
.readingslabelleft
{
  text-align:left;
}
.readingslabelright
{
  float:right
}
.chart
{
  height: 450px; overflow-x: scroll;
}
.topdiv{text-align:center;
  padding-top: 50px;
}
.heartbeatimg
{
  width: 60; height: 60; vertical-align:middle
}
.header
{
  display: inline-block; vertical-align:middle; padding-left: 20px;
}
.dateform
{
  padding: 50px;
}
.graphheader
{
  padding-top: 150px; padding-bottom: 40px;
}
.readingstableheader
{
  margin-top: 100px;
}
.hide
{
  display: none;
}
.tablereading{
  width: 100%; table-layout: fixed;
}

  </style>
</head>

<body>
    <!-- ***** Header Area Start ***** -->
<header class="header-area">
  <!-- Top Header Area -->
 

  <!-- Main Header Area -->
  <div class="main-header-area" id="stickyHeader">
      <div class="container h-100">
          <div class="row h-100 align-items-center">
              <div class="col-12 h-100">
                  <div class="main-menu h-100">
                      <nav class="navbar h-100 navbar-expand-lg">
                          <!-- Logo Area  -->
                          <a class="navbar-brand" href="/userdashboard"><img src="img/core-img/logo.png" alt="Logo" ></a>

                          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#medilifeMenu" aria-controls="medilifeMenu" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>

                          <div class="collapse navbar-collapse" id="medilifeMenu">
                              <!-- Menu Area -->
                              <ul class="navbar-nav ml-auto">
                                  <li class="nav-item active">
                                      <a class="nav-link" href="/userdashboard">Home <span class="sr-only">(current)</span></a>
                                  </li>
                                  <li class="nav-item">
                                      <a class="nav-link" href="/call">Call</a>
                                  </li>
                                  <li class="nav-item">
                                      <a class="nav-link" href="/doctorProfile">Profile</a>
                                  </li>
                                  <li class="nav-item">
                                      <a class="nav-link" href="/logout">Logout</a>
                                  </li>
                              </ul>
                              <!-- Appointment Button -->
                          </div>
                      </nav>
                  </div>
              </div>
          </div>
      </div>
  </div>
</header>


  <div class="topdiv"> <h1 class="header">Data Dashboard of User</h1> </div>
  <h3><%=userdetails.firstname %></h3>

    <form action="/usersdashboard" class="dateform" method="post">
      <label for="date">Select date to show data of user:</label>
      <input type="date" id="date" name="date">
      <input type="hidden" id="deviceid" name="deviceid" value=<%=userdetails.deviceid %> >
      <input type="hidden" id="deviceid" name="firstname" value=<%=userdetails.firstname %> >
      <input type="submit">
    </form>
  
    <button class="btn" id="heartToggle"><i class="fa fa-heartbeat" ></i> Heart</button>
    <button class="btn" id="bloodpressureToggle"><i class="fa fa-heart" ></i> Blood Pressure</button>
    <button class="btn" id="temperatureToggle"><i class="fa fa-thermometer" ></i> Temperature</button>
    <button class="btn" id="readingsTableToggle"><i class="fa fa-database" ></i> All readings</button>


    <br><br>
    

    <div>
      <% averages.forEach(function(average){%>

    <div id ="heartDashboard" class="heartDashboard">
      <div id="readingsSummary" class="readingsSummary" >
        <h3>Heart</h3>
        <h4>Heart Rate (Beats per minute)</h4>
        Heart rate is the number of times your heart beats per minute
        <p class="readingslabeltop">
          Heart Rate Max:
          <span class="readingslabelright">
            <%= average.heartratemax %> BPM
          </span>
        </p>
        <p class="readingslabelleft">
          Heart Rate Min:
          <span class="readingslabelright">
            <%= average.heartratemin %> BPM
          </span>
        </p>
        <p class="readingslabelleft">
          Heart Rate Average:
          <span class="readingslabelright">
            <%= average.heartrateavg %> BPM
          </span>
        </p>

        <h4>Heart Rate Variability (miliseconds)</h4>
        Heart rate variability is the difference in time between the beats of your heart, measured in milliseconds (ms).       
        <p class="readingslabeltop">
          Heart Rate Variability Max:
          <span class="readingslabelright">
            <%= average.heartratevariabilitymax %> ms
          </span>
        </p>
        <p class="readingslabelleft">
          Heart Rate Variability Min:
          <span class="readingslabelright">
            <%= average.heartratevariabilitymin %> ms
          </span>
        </p>
        <p class="readingslabelleft">
          Heart Rate Variability Average:
          <span class="readingslabelright">
            <%= average.heartratevariabilityavg %> ms
          </span>
        </p>

        <h3>Respiratory Rate (Breaths Per Minute)</h3>
        Respiratory rate is the number of breaths you take per minute
        <p class="readingslabeltop">
          Respiratory Rate Max:
          <span class="readingslabelright">
            <%= average.respiratoryRatemax %> BPM
          </span>
        </p>
        <p class="readingslabelleft">
          Respiratory Rate Min:
          <span class="readingslabelright">
            <%= average.respiratoryRatemin %> BPM
          </span>
        </p>
        <p class="readingslabelleft">
          Respiratory Rate Average:
          <span class="readingslabelright">
            <%= average.respiratoryRateavg %> BPM
          </span>
        </p>
       </div>
        <div id="charting1" class="chart"></div>
      </div>

       

        <div id = "bloodpressureDashboard" class="bloodpressureDashboard">
          <div id="readingsSummary" class="readingsSummary">

        <h3>Blood Pressure</h3>
        <h4>Diastolic (millimeters of mercury)</h4>
        The pressure in your arteries when your heart beats.
        <p class="readingslabeltop">
          Diastolic Max:
          <span class="readingslabelright">
            <%= average.diastolicmax %> mmHg
          </span>
        </p>
        <p class="readingslabelleft">
          Diastolic Min:
          <span class="readingslabelright">
            <%= average.diastolicmin %> mmHg
          </span>
        </p>
        <p class="readingslabelleft">
          Diastolic Average:
          <span class="readingslabelright">
            <%= average.diastolicavg %> mmHg
          </span>
        </p>

        <h4>Systolic (millimeters of mercury)</h4>
        The pressure in your arteries when your heart rests between beats.
        <p class="readingslabeltop">
          Systolic Max:
          <span class="readingslabelright">
            <%= average.systolicmax %> mmHg
          </span>
        </p>
        <p class="readingslabelleft">
          Systolic Min:
          <span class="readingslabelright">
            <%= average.systolicmin %> mmHg
          </span>
        </p>
        <p class="readingslabelleft">
          Systolic Average:
          <span class="readingslabelright">
            <%= average.systolicavg %> mmHg
          </span>
        </p>
        </div>  
        <div id="charting2" class="chart"></div>

        </div>  

        <div id="temperatureDashboard" class="temperatureDashboard">

          <div id="readingsSummary" class="readingsSummary">

        <h3>Body Temperature</h3>
        Your body temperature
        <p class="readingslabeltop">
          Temperature Max:
          <span class="readingslabelright">
            <%= average.temperaturemax %> ¬∞C
          </span>
        </p>
        <p class="readingslabelleft">
          Temperature Min:
          <span class="readingslabelright">
            <%= average.temperaturemin %> ¬∞C
          </span>
        </p>
        <p class="readingslabelleft">
          Temperature Average:
          <span class="readingslabelright">
            <%= average.temperatureavg %> ¬∞C
          </span>
        </p>
        </div>  
        <div id="charting3" class="chart"></div>

</div>


        <% }); %>
    </div>

  

    <div id="readingsTable">
      <h1 class="readingstableheader">All data readings</h1>
    <div class="tbl-header">
      <table cellpadding="0" cellspacing="0" border="0" class="tablereading">
        <thead>
          <tr>
            <th>Reading No.</th>
            <th>Heart rate (BPM)</th>
            <th>Heart Rate Variability (ms)</th>
            <th>Respiratory Rate (BPM)</th>
            <th>Diastolic Blood Pressure (mmHg)</th>
            <th>Systolic Blood Pressure (mmHg) </th>
            <th>Body Temperature (¬∞C)</th>
  
          </tr>
        </thead>
      </table>
    </div>
    <div class="tbl-content">
      <table cellpadding="0" cellspacing="0" border="0" class="tablereading">
        <tbody>
          <% 
          var number=0 
          var heartrate=["HeartRate"] 
          var heartratevariability=["HeartRateVariability"] 
          var respiratoryRate=["RespiratoryRate"] 
          var diastolic=["Diastolic"] 
          var systolic=["Systolic"] 
          var temperature=["Temperature"] 
          var numberOfReadings=data.length 
          data.forEach(function(reading)
          {
            heartrate.push(reading.heartrate) 
            heartratevariability.push(reading.heartratevariability)
            respiratoryRate.push(reading.respiratoryRate) 
            diastolic.push(reading.diastolic)
            systolic.push(reading.systolic) 
            temperature.push(reading.temperature) 
            number++ 
            
            %>
  
  
            <tr>
              <td>
                <%= number %>
              </td>
              <td>
                <%= reading.heartrate %>
              </td>
              <td>
                <%= reading.heartratevariability %>
              </td>
              <td>
                <%= reading.respiratoryRate %>
              </td>
              <td>
                <%= reading.diastolic %>
              </td>
              <td>
                <%= reading.systolic %>
              </td>
              <td>
                <%= reading.temperature %>
              </td>
  
            </tr>
  
            <% }); %>
        </tbody>
      </table>
    </div>
    </div>
  <div id="heartratediv" data-heartrate=<%=heartrate %>></div>
  <div id="heartratevariabilitydiv" data-heartratevariability=<%=heartratevariability %>></div>
  <div id="respiratoryRatediv" data-respiratoryrate=<%=respiratoryRate %>></div>
  <div id="diastolicdiv" data-diastolic=<%=diastolic %>></div>
  <div id="systolicdiv" data-systolic=<%=systolic %>></div>
  <div id="temperaturediv" data-temperature=<%=temperature %>></div>
  <div id="numberofreadingsdiv" data-numberofreadings=<%=numberOfReadings %>></div>




</body>


<script>

  var existCondition = setInterval(function () {

    if (document.getElementById('temperaturediv') && document.getElementById('heartratediv') && document.getElementById('systolicdiv') && document.getElementById('diastolicdiv') && document.getElementById('systolicdiv') && document.getElementById('respiratoryRatediv') && document.getElementById('heartratevariabilitydiv')) {
      console.log("Exists!");
      clearInterval(existCondition);

      var heartratedata = document.getElementById('heartratediv').dataset.heartrate
      var heartratecolumn = heartratedata.split(',')

      var heartratevariabilitydata = document.getElementById('heartratevariabilitydiv').dataset.heartratevariability
      var heartratevariabilitycolumn = heartratevariabilitydata.split(',')

      var respiratoryRatedata = document.getElementById('respiratoryRatediv').dataset.respiratoryrate
      var respiratoryRatecolumn = respiratoryRatedata.split(',')

      var diastolicdata = document.getElementById('diastolicdiv').dataset.diastolic
      var diastoliccolumn = diastolicdata.split(',')

      var systolicdata = document.getElementById('systolicdiv').dataset.systolic
      var systoliccolumn = systolicdata.split(',')

      var temperaturedata = document.getElementById('temperaturediv').dataset.temperature
      var temperaturecolumn = temperaturedata.split(',')

      var numberOfReadings = document.getElementById('numberofreadingsdiv').dataset.numberofreadings
      var width = numberOfReadings * 5


      bb.generate({
        bindto: "#charting1",
        data: {
          columns: [
            heartratecolumn,
            heartratevariabilitycolumn,
            respiratoryRatecolumn,

          ],
          types: {
            HeartRate: "spline",
            HeartRateVariability: "spline",
            RespiratoryRate: "spline"
          },
          colors: {
            HeartRate: "red",
            BloodPressure: "blue",
            RespiratoryRate: "green"

          }
        },
        
        axis:
        {
          y: {


            tick: {
              stepSize: 5
            }
          }
        },
          
        size:
        {
          width: width
        }
    

      });

      bb.generate({
        bindto: "#charting2",
        data: {
          columns: [
            diastoliccolumn,
            systoliccolumn,
            ,

          ],
          types: {
            Diastolic: "spline",
            Systolic: "spline",
          },
          colors: {
            Diastolic: "red",
            Systolic: "blue",

          }
        },
        axis:
        {
          y: {
            min: 0,


            tick: {
              stepSize: 5
            }
          }
        },
        size:
        {
          width: width
        }


      });

      bb.generate({
        bindto: "#charting3",
        data: {
          columns: [
            temperaturecolumn,

          ],
          types: {
            Temperature: "area-spline",
          },
          colors: {
            Temperature: "green",

          }
        },
        axis:
        {
          y: {
            min: 35,
            max: 40,
            tick: {
              stepSize: 0.5
            }
          }
        },
        size:
        {
          width: width
        }
      });

    }


    const heartToggle = document.getElementById('heartToggle');

heartToggle.addEventListener('click', () => {
         console.log('yes')

          const heartDashboard= document.getElementById('heartDashboard');

          if (heartDashboard.style.display === 'none') {
            // üëáÔ∏è this SHOWS the form
            var bloodpressureDashboard= document.getElementById('bloodpressureDashboard');
            var temperatureDashboard= document.getElementById('temperatureDashboard');
            var readingsTable = document.getElementById('readingsTable');
            readingsTable.style.display = 'none';
            bloodpressureDashboard.style.display = 'none';
            temperatureDashboard.style.display = 'none';

            heartDashboard.style.display = 'block';


          } else {
            // üëáÔ∏è this HIDES the form
            heartDashboard.style.display = 'none';
          }
        });


        const bloodpressureToggle = document.getElementById('bloodpressureToggle');

        bloodpressureToggle.addEventListener('click', () => {

        const bloodpressureDashboard= document.getElementById('bloodpressureDashboard');

        if (bloodpressureDashboard.style.display === 'none') {
          // üëáÔ∏è this SHOWS the form
            var heartDashboard= document.getElementById('heartDashboard');
            var temperatureDashboard= document.getElementById('temperatureDashboard');
            var readingsTable = document.getElementById('readingsTable');
            readingsTable.style.display = 'none';
            heartDashboard.style.display = 'none';
            temperatureDashboard.style.display = 'none';

          bloodpressureDashboard.style.display = 'block';
        } else {
          // üëáÔ∏è this HIDES the form
          bloodpressureDashboard.style.display = 'none';
        }
      });


      const temperatureToggle = document.getElementById('temperatureToggle');

      temperatureToggle.addEventListener('click', () => {

        const temperatureDashboard= document.getElementById('temperatureDashboard');

        if (temperatureDashboard.style.display === 'none') {
          // üëáÔ∏è this SHOWS the form
            var heartDashboard= document.getElementById('heartDashboard');
            var bloodpressureDashboard= document.getElementById('bloodpressureDashboard');
            var readingsTable = document.getElementById('readingsTable');

            readingsTable.style.display = 'none';
            heartDashboard.style.display = 'none';
            bloodpressureDashboard.style.display = 'none';

          temperatureDashboard.style.display = 'block';
        } else {
          // üëáÔ∏è this HIDES the form
          temperatureDashboard.style.display = 'none';
        }
      });

      const readingsTableToggle = document.getElementById('readingsTableToggle');

      readingsTableToggle.addEventListener('click', () => {

const readingsTable= document.getElementById('readingsTable');

if (readingsTable.style.display === 'none') {

  var heartDashboard= document.getElementById('heartDashboard');
  var bloodpressureDashboard= document.getElementById('bloodpressureDashboard');
  var temperatureDashboard= document.getElementById('temperatureDashboard');

  temperatureDashboard.style.display = 'none';
  heartDashboard.style.display = 'none';
  bloodpressureDashboard.style.display = 'none';

  // üëáÔ∏è this SHOWS the form
  readingsTable.style.display = 'block';
} else {
  // üëáÔ∏è this HIDES the form
  readingsTable.style.display = 'none';
}
});

  }, 100);



</script>

</html>

</script>
<!-- jQuery (Necessary for All JavaScript Plugins) -->
<script src="js/jquery/jquery-2.2.4.min.js"></script>
<!-- Popper js -->
<script src="js/popper.min.js"></script>
<!-- Bootstrap js -->
<script src="js/bootstrap.min.js"></script>
<!-- Plugins js -->
<script src="js/plugins.js"></script>
<!-- Active js -->
<script src="js/active.js"></script>
</html>
